<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Legion Control – Pixel Test</title>
<style>
body {
    margin:0;
    background:black;
    overflow:hidden;
    color:white;
    font-family:Arial;
}
#ui {
    position:absolute;
    top:10px;
    left:10px;
    background:rgba(0,0,0,.8);
    padding:10px;
    z-index:10;
}
canvas {
    image-rendering: pixelated;
    image-rendering: crisp-edges;
}
</style>
</head>
<body>

<div id="ui">
<select id="legion">
<option value="">— Select Legion —</option>
<option>Dark Angels</option>
<option>Emperor's Children</option>
<option>Iron Warriors</option>
<option>White Scars</option>
<option>Space Wolves</option>
<option>Imperial Fists</option>
<option>Night Lords</option>
<option>Blood Angels</option>
<option>Iron Hands</option>
<option>World Eaters</option>
<option>Ultramarines</option>
<option>Death Guard</option>
<option>Thousand Sons</option>
<option>Sons of Horus</option>
<option>Word Bearers</option>
<option>Salamanders</option>
<option>Raven Guard</option>
<option>Alpha Legion</option>
</select>
<button onclick="start()">Deploy</button>
<p style="font-size:12px">Click marine → WASD</p>
</div>

<!-- LOW INTERNAL RES, SCALED UP -->
<canvas id="c" width="320" height="180"
style="width:1280px;height:720px"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
ctx.imageSmoothingEnabled = false;

let units = [];
let selected = null;

const keys = { w:0,a:0,s:0,d:0 };

onkeydown = e => {
    const k = e.key.toLowerCase();
    if (k in keys) keys[k] = 1;
};
onkeyup = e => {
    const k = e.key.toLowerCase();
    if (k in keys) keys[k] = 0;
};

function start() {
    document.getElementById("ui").style.display="none";
    units = [];
    for (let i=0;i<8;i++) {
        units.push({
            x: 60 + i*20,
            y: 90,
            leader: i===4
        });
    }
    loop();
}

canvas.onclick = e => {
    const r = canvas.getBoundingClientRect();
    const mx = (e.clientX - r.left) * (canvas.width / r.width);
    const my = (e.clientY - r.top) * (canvas.height / r.height);

    selected = null;
    units.forEach((u,i)=>{
        if (Math.abs(mx-u.x)<6 && Math.abs(my-u.y)<6)
            selected=i;
    });
};

function update() {
    if (selected===null) return;
    const u = units[selected];
    if (keys.w) u.y -= 1;
    if (keys.s) u.y += 1;
    if (keys.a) u.x -= 1;
    if (keys.d) u.x += 1;
}

function draw() {
    ctx.fillStyle="#203b1f";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    units.forEach((u,i)=>{
        ctx.fillStyle = u.leader ? "#ffff55" : "#cccccc";
        ctx.fillRect(u.x-3,u.y-3,6,6);

        if (i===selected) {
            ctx.strokeStyle="#00ffff";
            ctx.strokeRect(u.x-5,u.y-5,10,10);
        }
    });
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
</script>
</body>
</html>
