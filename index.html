<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Pixel Extraction</title>
<style>
html,body{margin:0;overflow:hidden;background:#000;font-family:monospace;color:white}
canvas{image-rendering:pixelated}
#ui{position:absolute;top:10px;left:10px}
#menu{position:absolute;inset:0;background:#000d;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px}
button,input{font-family:monospace;font-size:14px}
#inventory{position:absolute;bottom:10px;right:10px;border:2px solid white;padding:6px}
</style>
</head>
<body>

<div id="menu">
<h2>PIXEL EXTRACTION</h2>
<input id="nameInput" placeholder="Username">
<select id="weaponSelect">
<option>Rifle</option>
<option>Rapid Rotary Cannon</option>
<option>Ark Blade</option>
<option>Power Hammer</option>
<option>Phasma Pack</option>
</select>
<button onclick="startGame()">START</button>
<button onclick="alert('Multiplayer groundwork only')">MULTIPLAYER</button>
</div>

<div id="ui"></div>
<div id="inventory">Weapon</div>
<canvas id="c"></canvas>

<script>
const c = document.getElementById("c"), ctx = c.getContext("2d");
c.width = innerWidth; c.height = innerHeight;

let shake=0;
let mapType = Math.floor(Math.random()*5);
let entities=[], bullets=[], particles=[];
let started=false, extraction=false, defendTimer=0, liftoff=0;

const player={
 x:0,y:0,hp:100,maxHp:100,
 weapon:"Rifle",
 speed:2,
 kills:0
};

const ship={x:600,y:400,hp:1000,active:false};

const keys={};
onkeydown=e=>keys[e.key]=true;
onkeyup=e=>keys[e.key]=false;

function startGame(){
 player.weapon=document.getElementById("weaponSelect").value;
 document.getElementById("menu").style.display="none";
 started=true;
 generateMap();
 spawnWave();
 setTimeout(()=>{ship.active=true},300000);
}

function generateMap(){
 entities=[];
 for(let i=0;i<200;i++){
  entities.push({
   x:Math.random()*2000-1000,
   y:Math.random()*2000-1000,
   t:["tree","rock","water","ruin","mountain"][Math.floor(Math.random()*5)]
  });
 }
}

function spawnWave(){
 for(let i=0;i<20;i++){
  entities.push({
   type:"monster",
   x:Math.random()*800-400,
   y:Math.random()*800-400,
   hp:40,maxHp:40
  });
 }
}

function shoot(){
 if(player.weapon==="Phasma Pack")return;
 bullets.push({
  x:player.x,y:player.y,
  dx:Math.cos(angle)*6,
  dy:Math.sin(angle)*6
 });
 shake=5;
}

let angle=0;

function update(){
 if(!started)return;
 angle=Math.atan2(mouse.y-c.height/2,mouse.x-c.width/2);

 if(keys.w)player.y-=player.speed;
 if(keys.s)player.y+=player.speed;
 if(keys.a)player.x-=player.speed;
 if(keys.d)player.x+=player.speed;

 if(keys[" "] && player.weapon==="Phasma Pack"){
  player.speed=4;
  particles.push({x:player.x,y:player.y,c:"orange",life:10});
 } else player.speed=2;

 bullets.forEach(b=>{
  b.x+=b.dx; b.y+=b.dy;
  entities.forEach(e=>{
   if(e.type==="monster" && Math.hypot(b.x-e.x,b.y-e.y)<12){
    e.hp-=20;
    particles.push({x:e.x,y:e.y,c:"#00ff00",life:10});
   }
  });
 });

 entities=entities.filter(e=>!(e.type==="monster"&&e.hp<=0));

 if(ship.active){
  defendTimer+=1/60;
  if(defendTimer>10 && keys.e){
   liftoff+=1/60;
   if(liftoff>5){alert("MISSION SUCCESS");location.reload();}
  }
 }

 if(player.hp<=0){alert("MISSION FAILED");location.reload();}
}

function drawEntity(e){
 ctx.save();
 ctx.translate(e.x-player.x+c.width/2,e.y-player.y+c.height/2);
 ctx.fillStyle="#0008";
 ctx.fillRect(-6,6,12,4);
 if(e.type==="monster"){
  ctx.fillStyle="#552200";
  ctx.fillRect(-8,-8,16,16);
  ctx.fillStyle="lime";
  ctx.fillRect(-10,-14,20*(e.hp/e.maxHp),3);
 } else {
  ctx.fillStyle={
   tree:"#2a5",
   rock:"#777",
   water:"#248",
   ruin:"#666",
   mountain:"#aaa"
  }[e.t];
  ctx.fillRect(-8,-8,16,16);
 }
 ctx.restore();
}

function drawPlayer(){
 ctx.save();
 ctx.translate(c.width/2,c.height/2);
 ctx.fillStyle="#0008";
 ctx.fillRect(-6,8,12,4);
 ctx.fillStyle="#3af";
 ctx.fillRect(-6,-10,12,20);
 ctx.restore();
}

function draw(){
 ctx.clearRect(0,0,c.width,c.height);
 if(shake>0){ctx.translate(Math.random()*shake,Math.random()*shake);shake--;}

 entities.forEach(drawEntity);
 bullets.forEach(b=>{
  ctx.fillStyle="yellow";
  ctx.fillRect(b.x-player.x+c.width/2,b.y-player.y+c.height/2,3,3);
 });

 drawPlayer();

 // UI
 ctx.fillStyle="red";
 ctx.fillRect(20,20,200*(player.hp/player.maxHp),10);
 ctx.strokeStyle="white";
 ctx.strokeRect(20,20,200,10);
}

const mouse={x:0,y:0};
onmousemove=e=>{mouse.x=e.clientX;mouse.y=e.clientY};
onclick=shoot;

function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
