<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>2D Tabletop War Game</title>
<style>
  body {
    margin: 0;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
  }

  #menu {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle, #222, #000);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  button {
    padding: 12px 24px;
    font-size: 18px;
    margin-top: 20px;
    cursor: pointer;
  }

  #ui {
    padding: 8px;
    background: #222;
  }

  canvas {
    display: block;
    background: #1a1a1a;
  }
</style>
</head>
<body>

<div id="menu">
  <h1>⚔️ Tabletop War: 2D ⚔️</h1>
  <p>Warhammer-style turn based strategy</p>
  <button onclick="startGame()">Start Game</button>
</div>

<div id="ui" style="display:none;">
  Turn: <span id="turnText"></span>
</div>

<canvas id="game" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const tileSize = 40;
const cols = 20;
const rows = 15;

let currentTurn = 0;
let selectedUnit = null;

const legions = [
  { name: "Imperium", color: "#3a7bd5", villain: "Warmaster" },
  { name: "Chaos", color: "#b00020", villain: "Dark Lord" },
  { name: "Orks", color: "#2ecc71", villain: "Waaagh Boss" },
  { name: "Eldar", color: "#9b59b6", villain: "Farseer" },
  { name: "Necrons", color: "#bdc3c7", villain: "Overlord" },
  { name: "Tyranids", color: "#e67e22", villain: "Hive Mind" }
];

let units = [];
let towns = [];

function startGame() {
  document.getElementById("menu").style.display = "none";
  document.getElementById("ui").style.display = "block";
  initGame();
  requestAnimationFrame(loop);
}

function initGame() {
  units = [];
  towns = [];

  legions.forEach((legion, i) => {
    units.push({
      x: i * 3 + 1,
      y: i * 2 + 1,
      hp: 10,
      legion: legion
    });
  });

  towns.push(
    { x: 8, y: 7, owner: null },
    { x: 14, y: 10, owner: null },
    { x: 3, y: 11, owner: null }
  );
}

canvas.addEventListener("click", e => {
  const rect = canvas.getBoundingClientRect();
  const x = Math.floor((e.clientX - rect.left) / tileSize);
  const y = Math.floor((e.clientY - rect.top) / tileSize);

  const clickedUnit = units.find(u => u.x === x && u.y === y);

  if (selectedUnit && !clickedUnit) {
    selectedUnit.x = x;
    selectedUnit.y = y;
    nextTurn();
    selectedUnit = null;
  } else {
    selectedUnit = clickedUnit;
  }

  towns.forEach(t => {
    if (t.x === x && t.y === y && selectedUnit) {
      t.owner = selectedUnit.legion;
    }
  });
});

function nextTurn() {
  currentTurn = (currentTurn + 1) % legions.length;
}

function drawGrid() {
  ctx.strokeStyle = "#333";
  for (let x = 0; x <= cols; x++) {
    ctx.beginPath();
    ctx.moveTo(x * tileSize, 0);
    ctx.lineTo(x * tileSize, rows * tileSize);
    ctx.stroke();
  }
  for (let y = 0; y <= rows; y++) {
    ctx.beginPath();
    ctx.moveTo(0, y * tileSize);
    ctx.lineTo(cols * tileSize, y * tileSize);
    ctx.stroke();
  }
}

function drawUnits() {
  units.forEach(u => {
    ctx.fillStyle = u.legion.color;
    ctx.fillRect(
      u.x * tileSize + 5,
      u.y * tileSize + 5,
      tileSize - 10,
      tileSize - 10
    );
  });
}

function drawTowns() {
  towns.forEach(t => {
    ctx.fillStyle = t.owner ? t.owner.color : "#666";
    ctx.beginPath();
    ctx.arc(
      t.x * tileSize + tileSize / 2,
      t.y * tileSize + tileSize / 2,
      10,
      0,
      Math.PI * 2
    );
    ctx.fill();
  });
}

function loop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawGrid();
  drawTowns();
  drawUnits();

  document.getElementById("turnText").textContent =
    legions[currentTurn].name + " (" + legions[currentTurn].villain + ")";

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
